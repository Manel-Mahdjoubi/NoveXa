<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoveXa - User Management</title>
    <link rel="stylesheet" href="admin-dashboard.css">
    <link rel="stylesheet" href="../students list/studentList.css">
    <link rel="stylesheet" href="admin-users.css">
    <link rel="icon" type="image/png" href="../logoE.png">
    <!-- Immediate Auth Check - Blocks page if not logged in -->
    <script>
        (function() {
            const token = localStorage.getItem('adminToken');
            if (!token) {
                document.documentElement.innerHTML = '';
                window.location.replace('admin-login.html');
            }
        })();
    </script>
    <style>
        /* Hide everything until authenticated */
        body { visibility: hidden; }
        body.authenticated { visibility: visible; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="navbar">
        <div class="logo">
            <img src="../Novexa_assets/global_assets/logo_top.svg" alt="NoveXa Logo" />
        </div>

        <nav class="nav-links">
            <a href="admin-dashboard.html">Dashboard</a>
            <a href="#" id="courseDeletionTab">Deletion Requests</a>
            <a href="#" id="studentsTab">Students</a>
            <a href="#" id="teachersTab">Teachers</a>
            <a href="admin-users.html" class="active">All Users</a>
            <a href="#" id="financeTab">Finance</a>
            <a href="#" id="statsTab">Statistics</a>
            <a href="#" id="adminsTab" style="display: none;">Admins</a>
        </nav>

        <div class="admin-actions">
            <span class="admin-username" id="adminUsername">Admin</span>
            <button class="logout-btn" id="logoutBtn">Logout</button>
        </div>
        <div class="menu-icon" id="menu-toggle">â˜°</div>
    </header>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <span class="mobile-menu-close" id="mobileMenuClose">&times;</span>
        <div class="mobile-menu-header" id="mobileMenuHeader">
            <span class="admin-username-mobile" id="adminUsernameMobile">Admin</span>
            <span class="admin-role-mobile" id="adminRoleMobile">Administrator</span>
        </div>
        <a href="admin-dashboard.html">Dashboard</a>
        <a href="#" id="courseDeletionTabMobile">Deletion Requests</a>
        <a href="#" id="studentsTabMobile">Students</a>
        <a href="#" id="teachersTabMobile">Teachers</a>
        <a href="admin-users.html" class="active">All Users</a>
        <a href="#" id="financeTabMobile">Finance</a>
        <a href="#" id="statsTabMobile">Statistics</a>
        <a href="#" id="adminsTabMobile" style="display: none;">Admins</a>
        <a href="#" id="logoutBtnMobile">Logout</a>
    </div>

    <!-- Main Content -->
    <main class="admin-container">
        <!-- Users Table Section -->
        <section class="requests-section">
            <div class="section-header">
                <h2 class="section-title">All Registered Users</h2>
                <div class="filter-controls">
                    <select class="filter-select" id="roleFilter">
                        <option value="all">All Roles</option>
                        <option value="Student">Students</option>
                        <option value="Teacher">Teachers</option>
                    </select>
                    <input 
                        type="text" 
                        class="search-input" 
                        id="searchInput" 
                        placeholder="Search by name or email..."
                    >
                </div>
            </div>

            <div id="loadingIndicator" style="text-align: center; padding: 2rem; color: #666;">
                <p>Loading users...</p>
            </div>
            
            <div id="errorMessage" style="display: none; background: rgba(231, 76, 60, 0.9); color: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px;"></div>
            
            <div class="table-container" id="usersTableContainer" style="display: none;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Role</th>
                            <th>Phone</th>
                            <th>Courses</th>
                            <th>Total Paid</th>
                            <th>Joined Date</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <!-- Users will be inserted here -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <script src="../js/api-config.js"></script>
    <script src="admin-credentials.js"></script>
    <script src="admin-users.js"></script>
</body>
</html>